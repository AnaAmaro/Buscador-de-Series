"use strict";const inputSearch=document.querySelector(".js-input"),buttonSearch=document.querySelector(".js-search_btn"),resultSlctr=document.querySelector(".result_shows"),favShows=document.querySelector(".shows_fav");let removeFavBtn=[],favShowsArray=[],showInfo=[],favId=[];function renderShowInfo(e){let a;showInfo=e,resultSlctr.innerHTML="";for(let e=0;e<showInfo.length;e++)a=null===showInfo[e].show.image?`<li class="show_info ${addFavouriteClass(e)}" data-liindex="${e}"><img src='https://via.placeholder.com/210x295/ffffff/666666/?text=TV' alt="${showInfo[e].show.name} class="show_image" avatar"><h3>${showInfo[e].show.name}</h3></li>`:`<li class="show_info" data-liindex="${e}"><img src=${showInfo[e].show.image.medium} alt="${showInfo[e].show.name} class="show_image" avatar"><h3>${showInfo[e].show.name}</h3></li>`,resultSlctr.innerHTML+=a;const t=document.querySelectorAll(".show_info");for(let e=0;e<t.length;e++)t[e].addEventListener("click",addFavourites)}function addFavourites(e){let a=e.currentTarget;!1===favId.includes(showInfo[a.dataset.liindex].show.id)&&(favShowsArray.push(showInfo[a.dataset.liindex]),favId.push(showInfo[a.dataset.liindex].show.id)),renderFavourites(),setLocalStorage(favShowsArray)}function removeFav(e){let a=parseInt(e.currentTarget.dataset.btnindex);favShowsArray.splice(a,1),favId.splice(a,1),renderFavourites(),setLocalStorage(favShowsArray)}function setLocalStorage(e){localStorage.setItem("favouritesShows",JSON.stringify(e))}function getFromLocalStorage(){const e=localStorage.getItem("favouritesShows");null!==e&&(favShowsArray=JSON.parse(e),renderFavourites())}function renderFavourites(){let e;favShows.innerHTML="";for(let a=0;a<favShowsArray.length;a++)e=null===favShowsArray[a].show.image?`<li class="show_info" data-liindex="${a}"><img src='https://via.placeholder.com/210x295/ffffff/666666/?text=TV' alt="${favShowsArray[a].show.name} class="show_image" avatar"><h3>${favShowsArray[a].show.name} </h3><button class="remove_fav" data-btnindex="${a}">x</button></li>`:`<li class="show_info" data-liindex="${a}"><img src=${favShowsArray[a].show.image.medium} alt="${favShowsArray[a].show.name} class="show_image" avatar"><h3>${favShowsArray[a].show.name} </h3><button class="remove_fav" data-btnindex="${a}">x</button><button class="fav_names>show names</button></li>`,favShows.innerHTML+=e;removeFavBtn=document.querySelectorAll(".remove_fav");for(let e of removeFavBtn)e.addEventListener("click",removeFav)}const addFavouriteClass=e=>favId.includes(showInfo[e].show.id)?"favourite":"";function getUrlTv(e){fetch(`https://api.tvmaze.com/search/shows?q=${e}`).then(e=>e.json()).then(e=>renderShowInfo(e)).catch(e=>console.log(e))}const clearInput=()=>inputSearch.value="",enterKey=e=>{if("Enter"===e.key){getUrlTv(inputSearch.value)}};buttonSearch.addEventListener("click",function(e){getUrlTv(inputSearch.value)}),inputSearch.addEventListener("click",clearInput),inputSearch.addEventListener("keyup",enterKey),getFromLocalStorage();
